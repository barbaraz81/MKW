points(c(start_x, end_x), c(start_y, end_y), type = "l")
}
}
node_nb_ends <- list()
node_ends <- list()
node_coords_x <- c()
node_coords_y <- c()
plot_depth <- max(x_ticks)
loop <- "go"
node <- 0
nodemax<--1
age_nodes<-c()
nbnodes<-c()
ultra<-c()
while (loop != "end" & node != nodemax) {
node <- node + 1
if(is.null(age_nodes)){
ultra<-ask("Do you want an ultrametric tree (i.e. without specifying ages of nodes) ? (Y/N)")
}
node_nb_ends[[node]] <- ask(paste0(
if(nodemax<0){"If their are no more nodes, type 'end', otherwise, i"}
else{"I"},
"f the ",node,
if (node == 1) {"-st"}
else{
if (node == 2) {"-nd"}
else{"-th"}},
" node is dichotomic, type 2, or type the number of branches arising from it"))
if (node_nb_ends[[node]] == "end") {
loop <- "end"
node_nb_ends <- node_nb_ends[-node]
node <- node - 1
nbnodes<-node
break
}
if (is.na(suppressWarnings(as.numeric(node_nb_ends[[node]]))) == TRUE) {
cat("You did not provide a number of branches, please provide it now or function will stop","\n")
node_nb_ends[[node]] <- ask(paste0(
if(nodemax<0){"If their are no more nodes, type 'end', otherwise, i"}
else{"I"},
"f the ",node,
if (node == 1) {"-st"}
else{
if (node == 2) {"-nd"}
else{"-th"}},
" node is dichotomic, type 2, or type the number of branches arising from it"))
}
node_ends[[node]] <- as.character(0)
for (i in 1:as.numeric(node_nb_ends[[node]])) {
node_ends[[node]][i] <- ask(paste0("If the ",i,
if (i == 1) {"-st"}
else{
if (i == 2) {"-nd"}
else{"-th"}},
" end is a taxon, type its name; if it is a node, type 'N' and its displayed number"))
if (((any(taxa == node_ends[[node]][i])) | (any(names(node_ends) == node_ends[[node]][i]))) == FALSE) {
cat("You did not provide the name of the written taxa or nodes, please provide it now or function will stop","\n")
node_ends[[node]][i] <- ask(paste0("If the ",i,
if (i == 1) {"-st"}
else{
if (i == 2) {"-nd"}
else{"-th"}},
" end is a taxon, type its name; if it is a node, type 'N' and its displayed number"))
}
if (suppressWarnings(is.na(as.numeric(paste(strsplit(node_ends[[node]][i], "")[[1]][-1],collapse=""))))==TRUE) {
node_ends[[node]][i] <- which(taxa == node_ends[[node]][i])
}
names(node_ends)[node] <- paste0("N", node)
}
if(nodemax>0){
age_nodes<-age_nodes
}
else{
if(ultra=="yes"|ultra=="Y"|ultra=="y"|ultra=="Yes"|ultra=="YES"){
age_nodes[node] <- max(c(suppressWarnings(max(age_taxa[na.omit(as.numeric(node_ends[[node]]))])), suppressWarnings(max(age_nodes[unlist(foreach(i=1:as.numeric(node_nb_ends[[node]]))%do%which((names(node_ends)==node_ends[[node]][i])))])))) + 1
}
else{
age_nodes[node] <- as.numeric(ask(paste0("Please give the age of the ",node,
if (node == 1) {"-st"}
else{
if (node == 2) {"-nd"}
else{"-th"}},
" node; if not known, type 0")))
}
if (age_nodes[node] < suppressWarnings(max(age_taxa[na.omit(as.numeric(node_ends[[node]]))]))) {
age_nodes[node] <- as.numeric(ask(paste0("Error: node age is more recent than (at least) on of the terminal taxa; please give its age or, if not known, type 0")))
}
if (age_nodes[node] == 0) {
if (length(age_nodes) == 1) {
age_nodes[node] <-suppressWarnings(max(age_taxa[na.omit(as.numeric(node_ends[[node]]))])) + 1
}
else{
age_nodes[node] <- max(c(suppressWarnings(max(age_taxa[na.omit(as.numeric(node_ends[[node]]))])), suppressWarnings(max(age_nodes[unlist(foreach(i=1:as.numeric(node_nb_ends[[node]]))%do%which((names(node_ends)==node_ends[[node]][i])))])))) + 1
}
}
}
max_depth <- max(c(max(age_taxa), max(age_nodes)),na.rm=TRUE)
node_coords_x[node] <- max(age_taxa) - age_nodes[node]
if (all(suppressWarnings(is.na(as.numeric(node_ends[[node]]))) == FALSE)) {
node_coords_y[node] <- mean(as.numeric(node_ends[[node]]))
}
else{
where <- suppressWarnings(is.na(as.numeric(node_ends[[node]])))
if (length(levels(as.factor(where))) == 2) {
prev_node <- as.numeric(paste(strsplit(node_ends[[node]][where == TRUE], "")[[1]][-1],collapse=""))
node_coords_y[node] <- mean(c(as.numeric(node_ends[[node]][where == FALSE]), node_coords_y[prev_node]))
}
else{
prev_node_1 <- as.numeric(paste(strsplit(node_ends[[node]][where == TRUE], "")[[1]][-1],collapse=""))
prev_node_2 <- as.numeric(paste(strsplit(node_ends[[node]][where == TRUE], "")[[2]][-1],collapse=""))
node_coords_y[node] <- mean(c(node_coords_y[prev_node_1], node_coords_y[prev_node_2]))
}
}
if (max_depth > plot_depth) {
plot.phylo(temp,edge.color = "white",x.lim = c((min(age_taxa) - (max_depth - max(age_taxa))), max(age_taxa)),label.offset = -0.25)
x_ticks <- invisible(axis(1,labels = NA,tick = FALSE,at = seq(floor(min(age_taxa) - (max_depth - max(age_taxa))), ceiling(max(age_taxa)), max(1,round(log10(max(age_taxa) - (min(age_taxa) - (max_depth - max(age_taxa)))))))))
if (min(x_ticks) < 0) {
x_labels <- rev(x_ticks - (min(x_ticks)))
}
else{
x_labels <- rev(x_ticks)
}
axis(1, at = x_ticks, labels = x_labels)
for (i in 1:max(c(1, length(node_ends) - 1))) {
text(node_coords_x[i],node_coords_y[i],labels = names(node_ends)[i],offset = 0)
x_offset <- strwidth("i")
for (j in 1:as.numeric(node_nb_ends[[i]])) {
start_x <- node_coords_x[i] + x_offset
end_x <- c()
if (suppressWarnings(is.na(as.numeric(node_ends[[i]][j]))) == FALSE) {
end_x <- node_coords_x[i] + age_nodes[i] - age_taxa[as.numeric(node_ends[[i]][j])] - x_offset
}
else{
end_x <- node_coords_x[i] + age_nodes[i] - age_nodes[as.numeric(paste(strsplit(node_ends[[i]][j], split = "")[[1]][-1],collapse=""))] - x_offset
}
start_y <- node_coords_y[i]
end_y <- c()
if (suppressWarnings(is.na(as.numeric(node_ends[[i]][j]))) == FALSE) {
end_y <- as.numeric(node_ends[[i]][j])
}
else{
end_y <- node_coords_y[as.numeric(paste(strsplit(node_ends[[i]][j], split = "")[[1]][-1],collapse=""))]
}
points(c(start_x, end_x), c(start_y, end_y), type = "l")
}
}
}
text(node_coords_x[node],node_coords_y[node],labels = names(node_ends)[node],offset = 0)
x_offset <- strwidth("i")
for (i in 1:as.numeric(node_nb_ends[[node]])) {
start_x <- node_coords_x[node] + x_offset
end_x <- c()
if (suppressWarnings(is.na(as.numeric(node_ends[[node]][i]))) == FALSE) {
end_x <- node_coords_x[node] + age_nodes[node] - age_taxa[as.numeric(node_ends[[node]][i])] - x_offset
}
else{
end_x <- node_coords_x[node] + age_nodes[node] - age_nodes[as.numeric(paste(strsplit(node_ends[[node]][i], split = "")[[1]][-1],collapse=""))] - x_offset
}
start_y <- node_coords_y[node]
end_y <- c()
if (suppressWarnings(is.na(as.numeric(node_ends[[node]][i]))) == FALSE) {
end_y <- as.numeric(node_ends[[node]][i])
}
else{
end_y <- node_coords_y[as.numeric(paste(strsplit(node_ends[[node]][i], split = "")[[1]][-1],collapse=""))]
}
points(c(start_x, end_x), c(start_y, end_y), type = "l")
}
}
node
node_coords_x[node]
names(node_ends)[node]
c((min(age_taxa) - (max_depth - max(age_taxa))), max(age_taxa))
plot.phylo(temp,edge.color = "white",x.lim = c((min(age_taxa) - (max_depth - max(age_taxa))), max(age_taxa)),label.offset = 0.25)
node_nb_ends <- list()
node_ends <- list()
node_coords_x <- c()
node_coords_y <- c()
plot_depth <- max(x_ticks)
loop <- "go"
node <- 0
nodemax<--1
age_nodes<-c()
nbnodes<-c()
ultra<-c()
while (loop != "end" & node != nodemax) {
node <- node + 1
if(is.null(age_nodes)){
ultra<-ask("Do you want an ultrametric tree (i.e. without specifying ages of nodes) ? (Y/N)")
}
node_nb_ends[[node]] <- ask(paste0(
if(nodemax<0){"If their are no more nodes, type 'end', otherwise, i"}
else{"I"},
"f the ",node,
if (node == 1) {"-st"}
else{
if (node == 2) {"-nd"}
else{"-th"}},
" node is dichotomic, type 2, or type the number of branches arising from it"))
if (node_nb_ends[[node]] == "end") {
loop <- "end"
node_nb_ends <- node_nb_ends[-node]
node <- node - 1
nbnodes<-node
break
}
if (is.na(suppressWarnings(as.numeric(node_nb_ends[[node]]))) == TRUE) {
cat("You did not provide a number of branches, please provide it now or function will stop","\n")
node_nb_ends[[node]] <- ask(paste0(
if(nodemax<0){"If their are no more nodes, type 'end', otherwise, i"}
else{"I"},
"f the ",node,
if (node == 1) {"-st"}
else{
if (node == 2) {"-nd"}
else{"-th"}},
" node is dichotomic, type 2, or type the number of branches arising from it"))
}
node_ends[[node]] <- as.character(0)
for (i in 1:as.numeric(node_nb_ends[[node]])) {
node_ends[[node]][i] <- ask(paste0("If the ",i,
if (i == 1) {"-st"}
else{
if (i == 2) {"-nd"}
else{"-th"}},
" end is a taxon, type its name; if it is a node, type 'N' and its displayed number"))
if (((any(taxa == node_ends[[node]][i])) | (any(names(node_ends) == node_ends[[node]][i]))) == FALSE) {
cat("You did not provide the name of the written taxa or nodes, please provide it now or function will stop","\n")
node_ends[[node]][i] <- ask(paste0("If the ",i,
if (i == 1) {"-st"}
else{
if (i == 2) {"-nd"}
else{"-th"}},
" end is a taxon, type its name; if it is a node, type 'N' and its displayed number"))
}
if (suppressWarnings(is.na(as.numeric(paste(strsplit(node_ends[[node]][i], "")[[1]][-1],collapse=""))))==TRUE) {
node_ends[[node]][i] <- which(taxa == node_ends[[node]][i])
}
names(node_ends)[node] <- paste0("N", node)
}
if(nodemax>0){
age_nodes<-age_nodes
}
else{
if(ultra=="yes"|ultra=="Y"|ultra=="y"|ultra=="Yes"|ultra=="YES"){
age_nodes[node] <- max(c(suppressWarnings(max(age_taxa[na.omit(as.numeric(node_ends[[node]]))])), suppressWarnings(max(age_nodes[unlist(foreach(i=1:as.numeric(node_nb_ends[[node]]))%do%which((names(node_ends)==node_ends[[node]][i])))])))) + 1
}
else{
age_nodes[node] <- as.numeric(ask(paste0("Please give the age of the ",node,
if (node == 1) {"-st"}
else{
if (node == 2) {"-nd"}
else{"-th"}},
" node; if not known, type 0")))
}
if (age_nodes[node] < suppressWarnings(max(age_taxa[na.omit(as.numeric(node_ends[[node]]))]))) {
age_nodes[node] <- as.numeric(ask(paste0("Error: node age is more recent than (at least) on of the terminal taxa; please give its age or, if not known, type 0")))
}
if (age_nodes[node] == 0) {
if (length(age_nodes) == 1) {
age_nodes[node] <-suppressWarnings(max(age_taxa[na.omit(as.numeric(node_ends[[node]]))])) + 1
}
else{
age_nodes[node] <- max(c(suppressWarnings(max(age_taxa[na.omit(as.numeric(node_ends[[node]]))])), suppressWarnings(max(age_nodes[unlist(foreach(i=1:as.numeric(node_nb_ends[[node]]))%do%which((names(node_ends)==node_ends[[node]][i])))])))) + 1
}
}
}
max_depth <- max(c(max(age_taxa), max(age_nodes)),na.rm=TRUE)
node_coords_x[node] <- max(age_taxa) - age_nodes[node]
if (all(suppressWarnings(is.na(as.numeric(node_ends[[node]]))) == FALSE)) {
node_coords_y[node] <- mean(as.numeric(node_ends[[node]]))
}
else{
where <- suppressWarnings(is.na(as.numeric(node_ends[[node]])))
if (length(levels(as.factor(where))) == 2) {
prev_node <- as.numeric(paste(strsplit(node_ends[[node]][where == TRUE], "")[[1]][-1],collapse=""))
node_coords_y[node] <- mean(c(as.numeric(node_ends[[node]][where == FALSE]), node_coords_y[prev_node]))
}
else{
prev_node_1 <- as.numeric(paste(strsplit(node_ends[[node]][where == TRUE], "")[[1]][-1],collapse=""))
prev_node_2 <- as.numeric(paste(strsplit(node_ends[[node]][where == TRUE], "")[[2]][-1],collapse=""))
node_coords_y[node] <- mean(c(node_coords_y[prev_node_1], node_coords_y[prev_node_2]))
}
}
if (max_depth > plot_depth) {
plot.phylo(temp,edge.color = "white",x.lim = c((min(age_taxa) - (max_depth - max(age_taxa))), max(age_taxa)),label.offset = 0.25)
x_ticks <- invisible(axis(1,labels = NA,tick = FALSE,at = seq(floor(min(age_taxa) - (max_depth - max(age_taxa))), ceiling(max(age_taxa)), max(1,round(log10(max(age_taxa) - (min(age_taxa) - (max_depth - max(age_taxa)))))))))
if (min(x_ticks) < 0) {
x_labels <- rev(x_ticks - (min(x_ticks)))
}
else{
x_labels <- rev(x_ticks)
}
axis(1, at = x_ticks, labels = x_labels)
for (i in 1:max(c(1, length(node_ends) - 1))) {
text(node_coords_x[i],node_coords_y[i],labels = names(node_ends)[i],offset = 0)
x_offset <- strwidth("i")
for (j in 1:as.numeric(node_nb_ends[[i]])) {
start_x <- node_coords_x[i] + x_offset
end_x <- c()
if (suppressWarnings(is.na(as.numeric(node_ends[[i]][j]))) == FALSE) {
end_x <- node_coords_x[i] + age_nodes[i] - age_taxa[as.numeric(node_ends[[i]][j])] - x_offset
}
else{
end_x <- node_coords_x[i] + age_nodes[i] - age_nodes[as.numeric(paste(strsplit(node_ends[[i]][j], split = "")[[1]][-1],collapse=""))] - x_offset
}
start_y <- node_coords_y[i]
end_y <- c()
if (suppressWarnings(is.na(as.numeric(node_ends[[i]][j]))) == FALSE) {
end_y <- as.numeric(node_ends[[i]][j])
}
else{
end_y <- node_coords_y[as.numeric(paste(strsplit(node_ends[[i]][j], split = "")[[1]][-1],collapse=""))]
}
points(c(start_x, end_x), c(start_y, end_y), type = "l")
}
}
}
text(node_coords_x[node],node_coords_y[node],labels = names(node_ends)[node],offset = 0)
x_offset <- strwidth("i")
for (i in 1:as.numeric(node_nb_ends[[node]])) {
start_x <- node_coords_x[node] + x_offset
end_x <- c()
if (suppressWarnings(is.na(as.numeric(node_ends[[node]][i]))) == FALSE) {
end_x <- node_coords_x[node] + age_nodes[node] - age_taxa[as.numeric(node_ends[[node]][i])] - x_offset
}
else{
end_x <- node_coords_x[node] + age_nodes[node] - age_nodes[as.numeric(paste(strsplit(node_ends[[node]][i], split = "")[[1]][-1],collapse=""))] - x_offset
}
start_y <- node_coords_y[node]
end_y <- c()
if (suppressWarnings(is.na(as.numeric(node_ends[[node]][i]))) == FALSE) {
end_y <- as.numeric(node_ends[[node]][i])
}
else{
end_y <- node_coords_y[as.numeric(paste(strsplit(node_ends[[node]][i], split = "")[[1]][-1],collapse=""))]
}
points(c(start_x, end_x), c(start_y, end_y), type = "l")
}
}
node_nb_ends <- list()
node_ends <- list()
node_coords_x <- c()
node_coords_y <- c()
plot_depth <- max(x_ticks)
loop <- "go"
node <- 0
nodemax<--1
age_nodes<-c()
nbnodes<-c()
ultra<-c()
while (loop != "end" & node != nodemax) {
node <- node + 1
if(is.null(age_nodes)){
ultra<-ask("Do you want an ultrametric tree (i.e. without specifying ages of nodes) ? (Y/N)")
}
node_nb_ends[[node]] <- ask(paste0(
if(nodemax<0){"If their are no more nodes, type 'end', otherwise, i"}
else{"I"},
"f the ",node,
if (node == 1) {"-st"}
else{
if (node == 2) {"-nd"}
else{"-th"}},
" node is dichotomic, type 2, or type the number of branches arising from it"))
if (node_nb_ends[[node]] == "end") {
loop <- "end"
node_nb_ends <- node_nb_ends[-node]
node <- node - 1
nbnodes<-node
break
}
if (is.na(suppressWarnings(as.numeric(node_nb_ends[[node]]))) == TRUE) {
cat("You did not provide a number of branches, please provide it now or function will stop","\n")
node_nb_ends[[node]] <- ask(paste0(
if(nodemax<0){"If their are no more nodes, type 'end', otherwise, i"}
else{"I"},
"f the ",node,
if (node == 1) {"-st"}
else{
if (node == 2) {"-nd"}
else{"-th"}},
" node is dichotomic, type 2, or type the number of branches arising from it"))
}
node_ends[[node]] <- as.character(0)
for (i in 1:as.numeric(node_nb_ends[[node]])) {
node_ends[[node]][i] <- ask(paste0("If the ",i,
if (i == 1) {"-st"}
else{
if (i == 2) {"-nd"}
else{"-th"}},
" end is a taxon, type its name; if it is a node, type 'N' and its displayed number"))
if (((any(taxa == node_ends[[node]][i])) | (any(names(node_ends) == node_ends[[node]][i]))) == FALSE) {
cat("You did not provide the name of the written taxa or nodes, please provide it now or function will stop","\n")
node_ends[[node]][i] <- ask(paste0("If the ",i,
if (i == 1) {"-st"}
else{
if (i == 2) {"-nd"}
else{"-th"}},
" end is a taxon, type its name; if it is a node, type 'N' and its displayed number"))
}
if (suppressWarnings(is.na(as.numeric(paste(strsplit(node_ends[[node]][i], "")[[1]][-1],collapse=""))))==TRUE) {
node_ends[[node]][i] <- which(taxa == node_ends[[node]][i])
}
names(node_ends)[node] <- paste0("N", node)
}
if(nodemax>0){
age_nodes<-age_nodes
}
else{
if(ultra=="yes"|ultra=="Y"|ultra=="y"|ultra=="Yes"|ultra=="YES"){
age_nodes[node] <- max(c(suppressWarnings(max(age_taxa[na.omit(as.numeric(node_ends[[node]]))])), suppressWarnings(max(age_nodes[unlist(foreach(i=1:as.numeric(node_nb_ends[[node]]))%do%which((names(node_ends)==node_ends[[node]][i])))])))) + 1
}
else{
age_nodes[node] <- as.numeric(ask(paste0("Please give the age of the ",node,
if (node == 1) {"-st"}
else{
if (node == 2) {"-nd"}
else{"-th"}},
" node; if not known, type 0")))
}
if (age_nodes[node] < suppressWarnings(max(age_taxa[na.omit(as.numeric(node_ends[[node]]))]))) {
age_nodes[node] <- as.numeric(ask(paste0("Error: node age is more recent than (at least) on of the terminal taxa; please give its age or, if not known, type 0")))
}
if (age_nodes[node] == 0) {
if (length(age_nodes) == 1) {
age_nodes[node] <-suppressWarnings(max(age_taxa[na.omit(as.numeric(node_ends[[node]]))])) + 1
}
else{
age_nodes[node] <- max(c(suppressWarnings(max(age_taxa[na.omit(as.numeric(node_ends[[node]]))])), suppressWarnings(max(age_nodes[unlist(foreach(i=1:as.numeric(node_nb_ends[[node]]))%do%which((names(node_ends)==node_ends[[node]][i])))])))) + 1
}
}
}
max_depth <- max(c(max(age_taxa), max(age_nodes)),na.rm=TRUE)
node_coords_x[node] <- max(age_taxa) - age_nodes[node]
if (all(suppressWarnings(is.na(as.numeric(node_ends[[node]]))) == FALSE)) {
node_coords_y[node] <- mean(as.numeric(node_ends[[node]]))
}
else{
where <- suppressWarnings(is.na(as.numeric(node_ends[[node]])))
if (length(levels(as.factor(where))) == 2) {
prev_node <- as.numeric(paste(strsplit(node_ends[[node]][where == TRUE], "")[[1]][-1],collapse=""))
node_coords_y[node] <- mean(c(as.numeric(node_ends[[node]][where == FALSE]), node_coords_y[prev_node]))
}
else{
prev_node_1 <- as.numeric(paste(strsplit(node_ends[[node]][where == TRUE], "")[[1]][-1],collapse=""))
prev_node_2 <- as.numeric(paste(strsplit(node_ends[[node]][where == TRUE], "")[[2]][-1],collapse=""))
node_coords_y[node] <- mean(c(node_coords_y[prev_node_1], node_coords_y[prev_node_2]))
}
}
if (max_depth > plot_depth) {
plot.phylo(temp,edge.color = "white",x.lim = c((min(age_taxa) - (max_depth - max(age_taxa))), max(age_taxa)),label.offset = 0)
x_ticks <- invisible(axis(1,labels = NA,tick = FALSE,at = seq(floor(min(age_taxa) - (max_depth - max(age_taxa))), ceiling(max(age_taxa)), max(1,round(log10(max(age_taxa) - (min(age_taxa) - (max_depth - max(age_taxa)))))))))
if (min(x_ticks) < 0) {
x_labels <- rev(x_ticks - (min(x_ticks)))
}
else{
x_labels <- rev(x_ticks)
}
axis(1, at = x_ticks, labels = x_labels)
for (i in 1:max(c(1, length(node_ends) - 1))) {
text(node_coords_x[i],node_coords_y[i],labels = names(node_ends)[i],offset = 0)
x_offset <- strwidth("i")
for (j in 1:as.numeric(node_nb_ends[[i]])) {
start_x <- node_coords_x[i] + x_offset
end_x <- c()
if (suppressWarnings(is.na(as.numeric(node_ends[[i]][j]))) == FALSE) {
end_x <- node_coords_x[i] + age_nodes[i] - age_taxa[as.numeric(node_ends[[i]][j])] - x_offset
}
else{
end_x <- node_coords_x[i] + age_nodes[i] - age_nodes[as.numeric(paste(strsplit(node_ends[[i]][j], split = "")[[1]][-1],collapse=""))] - x_offset
}
start_y <- node_coords_y[i]
end_y <- c()
if (suppressWarnings(is.na(as.numeric(node_ends[[i]][j]))) == FALSE) {
end_y <- as.numeric(node_ends[[i]][j])
}
else{
end_y <- node_coords_y[as.numeric(paste(strsplit(node_ends[[i]][j], split = "")[[1]][-1],collapse=""))]
}
points(c(start_x, end_x), c(start_y, end_y), type = "l")
}
}
}
text(node_coords_x[node],node_coords_y[node],labels = names(node_ends)[node],offset = 0)
x_offset <- strwidth("i")
for (i in 1:as.numeric(node_nb_ends[[node]])) {
start_x <- node_coords_x[node] + x_offset
end_x <- c()
if (suppressWarnings(is.na(as.numeric(node_ends[[node]][i]))) == FALSE) {
end_x <- node_coords_x[node] + age_nodes[node] - age_taxa[as.numeric(node_ends[[node]][i])] - x_offset
}
else{
end_x <- node_coords_x[node] + age_nodes[node] - age_nodes[as.numeric(paste(strsplit(node_ends[[node]][i], split = "")[[1]][-1],collapse=""))] - x_offset
}
start_y <- node_coords_y[node]
end_y <- c()
if (suppressWarnings(is.na(as.numeric(node_ends[[node]][i]))) == FALSE) {
end_y <- as.numeric(node_ends[[node]][i])
}
else{
end_y <- node_coords_y[as.numeric(paste(strsplit(node_ends[[node]][i], split = "")[[1]][-1],collapse=""))]
}
points(c(start_x, end_x), c(start_y, end_y), type = "l")
}
}
library(jacob.maugoust)
library(jacob.maugoust)
library(jacob.maugoust)
library(jacob.maugoust)
library(jacob.maugoust)
library(jacob.maugoust)
